<!DOCTYPE html>
<html>
  <head>
    <meta charset="UTF-8" />
    <title>Smartik- Add new student</title>
    <link rel="stylesheet" href="index.css" />
  </head>
  <body>
    <nav class="sidebar">
      <div class="logo">
        <img src="Vector.png" />
      </div>
      <i class="fa-solid fa-bars" id="btn"></i>
      <ul class="nav-links">
        <li>
          <a href="index.html"
            ><i class="fa-solid fa-users"></i><span>Students</span></a
          >
        </li>
        <li>
          <a href="exam.html"
            ><i class="fa-solid fa-clipboard-list"></i><span>Exams</span></a
          >
        </li>
        <li>
          <a href=""
            ><i class="fa-solid fa-chart-bar"></i><span>Reports</span></a
          >
        </li>
        <br />
        <br />
        <li>
          <a href="" class="logout"
            ><i class="fa-solid fa-circle-left"></i> <span>Logout</span></a
          >
        </li>
      </ul>
    </nav>
    <section>
      <h1 class="title">Add New Student</h1>
      <div class="form-container">
        <form id="form">
          <label for="examno">Exam number</label><br />
          <input
            type="text"
            name="examno"
            id="examno"
            placeholder="Exam Number"
            required
          /><br />
          <label for="name">First Name</label><br />
          <input
            type="text"
            name="name"
            id="name"
            placeholder="First Name"
          /><br />
          <label for="surname">Surname</label><br />
          <input
            type="text"
            name="surname"
            id="surname"
            placeholder="Surname"
          /><br />
          <div class="button">
            <button
              class="btn"
              type="button"
              onclick="window.location.href='index.html'"
            >
              Home
            </button>
            <button type="submit" class="btn" id="submit">Submit</button>
          </div>
        </form>
      </div>
    </section>
    <script>
      let btn = document.getElementById("btn");
      let sidebar = document.querySelector(".sidebar");
      btn.addEventListener("click", () => {
        sidebar.classList.toggle("active");
      });
      let root = "http://localhost:1323/api/v1/";
      document.getElementById("submit").addEventListener("click", submitForm);
      function submitForm(e) {
        e.preventDefault();
        const formElement = document.querySelector("#form");
        const data = {
          exam_number: formElement.examno.value,
          first_name: formElement.name.value,
          last_name: formElement.surname.value,
        };

        fetch(root + "students/create", {
          method: "POST",
          headers: { "Content-Type": "application/json" },
          body: JSON.stringify(data),
        })
          .then(function (response) {
            if (!response.ok) {
              throw new Error(`HTTP error! status: ${response.status}`);
            }
            return response.text();
          })
          .then(function (data) {
            if (data == "1") {
              alert("Student added.");
              document.getElementById("form").reset();
            } else {
              alert(data);
            }
          });
      }
    </script>
  </body>
</html>
