<!DOCTYPE html>
<html>

<head>
    <meta charset="UTF-8" />
    <title>Smartik-view all</title>
    <link rel="stylesheet" href="index.css" />
</head>

<body>
    <nav class="sidebar">
        <div class="logo">
            <img src="Vector.png">
        </div>
        <i class="fa-solid fa-bars" id="btn"></i>
        <ul class="nav-links">
            <li>
                <a href="#student"><i class="fa-solid fa-users"></i><span>Students</span></i></a>
            </li>
            <li>
                <a href=""><i class="fa-solid fa-clipboard-list"></i><span>Exams</span></i></a>
            </li>
            <li>
                <a href=""><i class="fa-solid fa-chart-bar"></i><span>Reports</span></a>
            </li>
            <br>
            <br>
            <li>
                <a href="" class="logout"><i class="fa-solid fa-circle-left"></i> <span>Logout</span></a>
            </li>
        </ul>
        </div>
        </nav>
    <section>
        <h1 class="title">View All Students</h1>
        <div class="container">
            <div class="buttons">
                <button class="btn" title="add new student"><a href="newstudent.html"><i class="fa-solid fa-plus"></i><span>New</span></a></button>
                <button class="btn" title="View all students"><a href="viewall.html">View All</a></button>
                <button class="btn" title="Search"><i class="fa-solid fa-magnifying-glass"></i></button>
            </div>
        <div id="students">
            <table>
                <thead>
                    <tr>
                        <th>Exam Number</th>
                        <th>Pass/Fail</th>
                        <th>Edit</th>
                        <th>Delete</th>         
                    </tr>
                </thead>
                <tbody id="student-body"></tbody>
            </table>
            <div id="message"></div>
        </div>
    </section>

    <script>
        let root = "http://localhost:1323/api/v1/";
            function fetchStudents() {
                fetch(root + 'students')
                    .then(function (response) {
                        return response.json();
                    })
                    .then(function (data) {
                        displayStudents(data);
                    });
            }
            function displayStudents(data) {
                const tbody = document.getElementById('student-body');
                const message = document.getElementById('message');

                tbody.innerHTML = '';
                message.innerHTML = '';

                if(!data || data.length === 0){
                    message.innerHTML = `<p>No students found. Please add a student to get started.</p>`;
                    return;
                }
                data.forEach(student => {
                    const row = document.createElement('tr');
                    row.onclick = () => editContact(student.id);

                    row.innerHTML = `
                   <td><h5>${student.exam_number}</h5></td>
                   <td>${student.pass ? 'Pass' : 'Fail'}</td>
                   <td><button onclick="edit(${student.id}); event.stopPropagation();"><i class="fa-solid fa-pen"></i></button></td>
                   <td><button onclick="deleteStudent(${student.id}); event.stopPropagation();"><i class="fa-solid fa-trash"></i></button></td>
    `;
                    tbody.appendChild(row);
                    function edit(){
                        window.open("edit.html", "_self");
                    }
                })
            }

    </script>
</body>
</html>